<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Pollution & Health: The Hidden Crisis in Indian Cities</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #1a1a1a;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }
        
        /* Header Section */
        .hero {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 60px 40px;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-family: 'Playfair Display', serif;
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.2;
            animation: fadeInUp 0.8s ease-out;
        }
        
        .subtitle {
            font-size: 20px;
            opacity: 0.95;
            font-weight: 300;
            max-width: 900px;
            line-height: 1.5;
            margin-bottom: 30px;
            animation: fadeInUp 0.8s ease-out 0.2s backwards;
        }
        
        .key-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 40px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, background 0.3s ease;
            animation: fadeInUp 0.8s ease-out 0.4s backwards;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.25);
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            font-weight: 400;
        }
        
        /* Content Sections */
        .content {
            padding: 60px;
        }
        
        .section {
            margin-bottom: 80px;
            animation: fadeIn 0.8s ease-out;
        }
        
        .section-header {
            margin-bottom: 30px;
        }
        
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 36px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 4px solid #667eea;
            display: inline-block;
        }
        
        .section-description {
            font-size: 16px;
            color: #555;
            max-width: 900px;
            line-height: 1.7;
            margin-top: 20px;
        }
        
        /* Info Boxes */
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px 25px;
            margin: 25px 0;
            border-radius: 0 8px 8px 0;
            transition: transform 0.3s ease;
        }
        
        .info-box:hover {
            transform: translateX(5px);
        }
        
        .info-box h3 {
            color: #667eea;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 12px;
        }
        
        .info-box p, .info-box ul {
            font-size: 14px;
            color: #555;
            line-height: 1.6;
        }
        
        .info-box ul {
            list-style-position: inside;
            margin-left: 0;
        }
        
        .info-box li {
            margin: 8px 0;
        }
        
        /* Visualization Containers */
        .viz-container {
            background: white;
            border-radius: 12px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            border: 1px solid #e0e0e0;
            transition: box-shadow 0.3s ease;
            overflow-x: auto;
            overflow-y: hidden;
            max-width: 100%;
        }
        
        .viz-container:hover {
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.1);
        }
        
        /* Responsive visualization wrapper */
        .viz-wrapper {
            min-width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: visible;
        }
        
        .viz-title {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .viz-subtitle {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
            font-style: italic;
        }
        
        /* Two-column layout for smaller visualizations */
        .viz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }
        
        /* Insights boxes */
        .insight-box {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(102, 126, 234, 0.2);
            transition: transform 0.3s ease;
        }
        
        .insight-box:hover {
            transform: translateY(-3px);
        }
        
        .insight-box h3 {
            color: #667eea;
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .insight-box h3::before {
            content: "💡";
            margin-right: 10px;
            font-size: 24px;
        }
        
        .insight-box p {
            font-size: 15px;
            color: #444;
            line-height: 1.7;
            margin: 10px 0;
        }
        
        .insight-box strong {
            color: #667eea;
            font-weight: 600;
        }
        
        /* WHO Guidelines Box */
        .guidelines-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { border-color: #ffc107; }
            50% { border-color: #ff9800; }
        }
        
        .guidelines-box h3 {
            color: #856404;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .guidelines-table {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .guideline-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .guideline-item:hover {
            transform: scale(1.05);
        }
        
        .guideline-value {
            font-size: 24px;
            font-weight: 700;
            color: #856404;
        }
        
        .guideline-label {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        /* Progress Indicators */
        .progress-indicator {
            display: flex;
            align-items: center;
            margin: 15px 0;
        }
        
        .progress-bar {
            flex: 1;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-right: 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 1s ease-out;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
        }
        
        .progress-value {
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Footer */
        .footer {
            background: #2c3e50;
            color: white;
            padding: 40px 60px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
        }
        
        .footer h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #667eea;
        }
        
        .footer p, .footer ul {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.6;
        }
        
        .footer ul {
            list-style: none;
        }
        
        .footer li {
            margin: 8px 0;
        }
        
        .footer a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer a:hover {
            color: #764ba2;
            text-decoration: underline;
        }
        
        /* Author info */
        .author-info {
            text-align: center;
            padding: 20px;
            background: #1a1a1a;
            color: white;
            font-size: 14px;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
        
        /* Loading spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-radius: 50%;
            border-top-color: #667eea;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero, .content {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 32px;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .viz-grid {
                grid-template-columns: 1fr;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
            }
            
            .guidelines-table {
                grid-template-columns: 1fr;
            }
            
            .viz-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Hero Section -->
        <div class="hero">
            <div class="hero-content">
                <h1>Air Pollution & Health: The Hidden Crisis in Indian Cities</h1>
                <p class="subtitle">
                    Every breath matters. Explore how outdoor and indoor air pollution affects respiratory health 
                    across major Indian cities, and discover the invisible connections between PM2.5 levels, 
                    household fuel choices, and childhood respiratory infections.
                </p>
                
                <div class="key-stats">
                    <div class="stat-card">
                        <div class="stat-number">8 Cities</div>
                        <div class="stat-label">Analyzed with Combined Data</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">6.7× WHO</div>
                        <div class="stat-label">Patna Exceeds Safe Limits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">40%</div>
                        <div class="stat-label">Homes Still Use Unclean Fuel</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3.3%</div>
                        <div class="stat-label">Children with Respiratory Infections</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            
            <!-- Introduction Section -->
            <div class="section">
                <div class="info-box">
                    <h3>Why This Matters to You</h3>
                    <p><strong>For Australians and Malaysians:</strong> While enjoying relatively clean air at home, understanding India's air quality crisis is crucial. Many of you may have family, business connections, or travel plans involving India. This visualization reveals health patterns that affect hundreds of millions of people and offers lessons for rapidly urbanizing regions across Asia-Pacific.</p>
                    <p style="margin-top: 10px;"><strong>Key Context:</strong> India's urban air quality challenges stem from vehicle emissions, industrial activity, construction dust, agricultural burning, and widespread use of solid fuels for cooking. The health impacts extend beyond borders through regional air masses and shared environmental challenges.</p>
                </div>

                <div class="guidelines-box">
                    <h3>⚠️ WHO Air Quality Guidelines (PM2.5)</h3>
                    <div class="guidelines-table">
                        <div class="guideline-item">
                            <div class="guideline-value">≤15 µg/m³</div>
                            <div class="guideline-label">Good<br>(Annual Average)</div>
                        </div>
                        <div class="guideline-item">
                            <div class="guideline-value">15-35 µg/m³</div>
                            <div class="guideline-label">Moderate<br>(Health Risk Increases)</div>
                        </div>
                        <div class="guideline-item">
                            <div class="guideline-value">>75 µg/m³</div>
                            <div class="guideline-label">Very Unhealthy<br>(Serious Health Impacts)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map Visualization -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Geographic Distribution: Where is Air Quality Worst?</h2>
                    <p class="section-description">
                        The Indo-Gangetic Plain (Delhi, Patna, Kolkata) faces the most severe air pollution challenges, 
                        with PM2.5 levels 2-7 times above WHO recommendations. Coastal cities like Chennai and Visakhapatnam 
                        benefit from sea breezes, showing relatively better air quality. Circle size represents pollution intensity, 
                        while color indicates WHO health risk categories.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="map"></div>
                </div>
                <div class="insight-box">
                    <h3>Key Geographic Insight</h3>
                    <p><strong>The Northern Crisis:</strong> Cities in the Indo-Gangetic Plain face a perfect storm of pollution. Patna's annual average (101.4 µg/m³) is <strong>6.7 times</strong> the WHO safe limit. Geographic factors trap pollution: mountain barriers block air circulation while winter temperature inversions create a "pollution dome" over northern cities.</p>
                    <p><strong>Coastal Advantage:</strong> Visakhapatnam (41.2 µg/m³) and Chennai (46.7 µg/m³) demonstrate how proximity to the coast improves air circulation, though even these "cleaner" cities exceed WHO guidelines by 3×.</p>
                </div>
            </div>

            <!-- Correlation Scatter Plot -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">The Double Burden: Outdoor & Indoor Air Pollution</h2>
                    <p class="section-description">
                        Cities with worse outdoor air quality also struggle with indoor pollution from cooking fuels. 
                        This scatter plot reveals a concerning pattern: as outdoor PM2.5 increases, the percentage of 
                        households using clean cooking fuel decreases. Hover over points to see detailed city data.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="scatter"></div>
                </div>
                <div class="insight-box">
                    <h3>The Dual Pollution Trap</h3>
                    <p><strong>Correlation Found:</strong> Analysis reveals a <strong>-0.52 correlation</strong> between outdoor PM2.5 and clean fuel adoption. Cities facing severe outdoor pollution typically have lower incomes and infrastructure development, leading to continued reliance on polluting cooking fuels like wood, dung, and kerosene.</p>
                    <p><strong>Impact on Women & Children:</strong> Since women and children spend more time indoors, they face disproportionate exposure to household air pollution. In Jaipur, where only 60% use clean fuel, families experience a toxic combination of both pollution sources.</p>
                </div>
            </div>

            <!-- Bar Chart Comparison -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">City-by-City Health Comparison</h2>
                    <p class="section-description">
                        Compare cities across three critical dimensions: outdoor air pollution (PM2.5), 
                        indoor air quality (clean fuel adoption), and respiratory health outcomes (ARI prevalence in children). 
                        Click legend items to isolate specific metrics.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="barchart"></div>
                </div>
                <div class="insight-box">
                    <h3>Unexpected Patterns in Respiratory Health</h3>
                    <p><strong>The Pune Paradox:</strong> Despite moderate outdoor pollution (49.8 µg/m³), Pune shows the highest acute respiratory infection rate (3.3%). This suggests healthcare access, disease reporting systems, and population density play significant roles beyond just air quality.</p>
                    <p><strong>Bangalore's Success:</strong> Reports virtually no ARI cases despite pollution levels of 51.9 µg/m³, possibly reflecting better healthcare infrastructure, higher clean fuel adoption (97.2%), and effective public health interventions.</p>
                </div>
            </div>

            <!-- Time Series Visualization -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Seasonal Patterns: PM2.5 Levels Throughout the Year</h2>
                    <p class="section-description">
                        Air pollution levels vary dramatically by season. This interactive visualization shows how PM2.5 
                        concentrations change month by month, with winter months showing severe spikes due to temperature 
                        inversions, crop burning, and festival celebrations.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="timeseries"></div>
                </div>
                <div class="insight-box">
                    <h3>Seasonal Pollution Dynamics</h3>
                    <p><strong>Winter Crisis:</strong> PM2.5 levels peak during winter months (Nov-Feb), with Delhi reaching 156 µg/m³ in January - over 10× WHO safe limits. Temperature inversions trap pollutants near ground level.</p>
                    <p><strong>Monsoon Relief:</strong> The lowest pollution occurs during monsoon season (Jun-Sep) when rain washes particulates from the air. Even then, most cities remain above WHO guidelines.</p>
                    <p><strong>Festival & Agriculture Impact:</strong> Post-Diwali celebrations and November stubble burning create visible spikes in pollution across northern cities.</p>
                </div>
            </div>

            <!-- Multi-Risk Heatmap -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Multi-Dimensional Health Risk Matrix</h2>
                    <p class="section-description">
                        This heatmap visualizes the combined health risk factors across cities. Darker colors indicate 
                        higher risk levels, helping identify which cities face the most severe multi-dimensional health challenges.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="heatmap"></div>
                </div>
                <div class="insight-box">
                    <h3>Risk Concentration Patterns</h3>
                    <p><strong>Highest Risk Cities:</strong> Patna and Kolkata show the darkest patterns across multiple indicators, confirming their status as high-priority intervention areas.</p>
                    <p><strong>Variable Risk Profiles:</strong> While Chennai has relatively lower air pollution, its child malnutrition rates remain concerning, showing that health risks vary across dimensions.</p>
                </div>
            </div>

            <!-- Health Impact Ranking -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Health Vulnerability Rankings</h2>
                    <p class="section-description">
                        Combining multiple health indicators – respiratory infections, malnutrition (stunting/wasting), 
                        and tobacco use – reveals which cities face the greatest overall health burdens. These factors 
                        interact with air pollution to amplify health risks.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="health_ranking"></div>
                </div>
                <div class="insight-box">
                    <h3>Vulnerability Factors Beyond Air Quality</h3>
                    <p><strong>Malnutrition Multiplies Risk:</strong> Kolkata and Patna show high rates of child malnutrition (29-34% stunted), making children more vulnerable to respiratory infections. Undernourished children have weaker immune systems and lung development.</p>
                    <p><strong>Tobacco Epidemic:</strong> Male tobacco use ranges from 9% (Chennai) to 42% (Kolkata). Combined with air pollution, tobacco users face exponentially higher risks of COPD, lung cancer, and cardiovascular disease. Kolkata's "triple burden" – high PM2.5, high tobacco use, and poor nutrition – creates a perfect storm for respiratory disease.</p>
                </div>
            </div>

            <!-- Interactive Parallel Coordinates -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Comprehensive City Health Profiles</h2>
                    <p class="section-description">
                        Explore detailed health profiles for each city using this interactive parallel coordinates visualization. 
                        Click on city names in the legend to highlight specific cities and compare them across all dimensions simultaneously.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="parallel"></div>
                </div>
            </div>

            <!-- Bubble Chart - Population Impact -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Population Impact Analysis</h2>
                    <p class="section-description">
                        This bubble chart shows the scale of impact by incorporating city population sizes. Larger bubbles 
                        represent more people affected, highlighting where interventions could benefit the most citizens.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="bubble_chart"></div>
                </div>
                <div class="insight-box">
                    <h3>Maximum Impact Opportunities</h3>
                    <p><strong>Kolkata's Scale:</strong> With over 14 million residents exposed to severe pollution (77.2 µg/m³), interventions here could benefit the largest number of people.</p>
                    <p><strong>Mid-size City Focus:</strong> Cities like Pune and Bangalore (5-10M population) offer opportunities for scalable pilot programs before wider implementation.</p>
                </div>
            </div>

            <!-- Radial Chart -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Air Quality Distribution by Population Category</h2>
                    <p class="section-description">
                        This radial visualization shows how air quality varies across different city size categories, 
                        revealing patterns between urbanization scale and pollution levels.
                    </p>
                </div>
                <div class="viz-container">
                    <div class="viz-wrapper" id="radial"></div>
                </div>
            </div>

            <!-- Conclusions -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">What Can Be Done?</h2>
                </div>
                
                <div class="viz-grid">
                    <div class="info-box">
                        <h3>🏭 Outdoor Air Quality Solutions</h3>
                        <ul>
                            <li>Transition to cleaner fuels and renewable energy</li>
                            <li>Strengthen vehicle emission standards (BS-VI implementation)</li>
                            <li>Regulate industrial emissions more strictly</li>
                            <li>Provide alternatives to crop burning (Happy Seeder technology)</li>
                            <li>Expand public transportation networks</li>
                            <li>Implement odd-even vehicle schemes during peak pollution</li>
                        </ul>
                    </div>
                    
                    <div class="info-box">
                        <h3>🏠 Indoor Air Quality Solutions</h3>
                        <ul>
                            <li>Subsidize LPG and electric cooking stoves (Ujjwala Yojana expansion)</li>
                            <li>Improve kitchen ventilation in homes</li>
                            <li>Promote cleaner biomass cookstoves</li>
                            <li>Educate about household air pollution risks</li>
                            <li>Support fuel-switching programs</li>
                            <li>Install air purifiers in schools and hospitals</li>
                        </ul>
                    </div>
                </div>
                
                <div class="info-box">
                    <h3>🎯 Quick Wins That Could Save Lives</h3>
                    <ul>
                        <li><strong>Accelerate LPG Adoption:</strong> If cities with low clean fuel use (Jaipur 60%, Patna 65%) reached Hyderabad's level (99.5%), millions would breathe cleaner indoor air</li>
                        <li><strong>Target Seasonal Events:</strong> Banning firecrackers during Diwali and providing crop-residue alternatives could cut winter pollution peaks by 30-40%</li>
                        <li><strong>Improve Tobacco Control:</strong> Reducing male tobacco use in high-prevalence cities (Kolkata 42%, Patna 40%) would provide immediate respiratory health benefits</li>
                        <li><strong>Strengthen Healthcare:</strong> Cities like Pune showing high ARI rates need better primary healthcare access and respiratory disease management</li>
                        <li><strong>Real-time Monitoring:</strong> Expand air quality monitoring networks and provide public alerts during high pollution days</li>
                    </ul>
                </div>

                <div class="insight-box">
                    <h3>Policy Success Stories</h3>
                    <p><strong>Delhi's Emergency Action Plan:</strong> Graded Response Action Plan (GRAP) activates different levels of pollution control measures based on air quality, including construction bans and traffic restrictions.</p>
                    <p><strong>Ujjwala Yojana Impact:</strong> This LPG subsidy program has provided over 80 million connections, dramatically improving indoor air quality for millions of families.</p>
                    <p><strong>BS-VI Fuel Standards:</strong> India's leap from BS-IV to BS-VI emission standards in 2020 matches European standards, reducing vehicle emissions by up to 80%.</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-content">
                <div>
                    <h3>Data Sources & Methodology</h3>
                    <p><strong>Air Quality Data:</strong> Combined air quality and health metrics dataset, 2023. Annual mean PM2.5 and PM10 concentrations for Indian cities.</p>
                    <p style="margin-top: 10px;"><strong>Health Data:</strong> National Family Health Survey (NFHS-5), 2019-2021. Ministry of Health and Family Welfare, Government of India. City-level indicators on respiratory health, household fuel use, tobacco consumption, and child nutrition.</p>
                    <p style="margin-top: 10px;"><strong>Time Series Data:</strong> Monthly PM2.5 measurements across major Indian cities, 2023.</p>
                    <p style="margin-top: 10px;"><strong>Visualization:</strong> Created using Vega-Lite visualization grammar v5. All data processing and analysis conducted using standardized CSV formats. Interactive elements powered by Vega-Embed.</p>
                </div>
                <div>
                    <h3>Further Reading</h3>
                    <ul>
                        <li><a href="https://www.who.int/teams/environment-climate-change-and-health/air-quality-and-health/policy-progress/who-air-quality-guidelines" target="_blank">WHO Air Quality Guidelines</a></li>
                        <li><a href="http://rchiips.org/nfhs/" target="_blank">National Family Health Survey (NFHS)</a></li>
                        <li><a href="https://app.cpcbccr.com/ccr/#/caaqm-dashboard-all/caaqm-landing" target="_blank">India Air Quality Monitoring</a></li>
                        <li><a href="https://ncap.moefcc.gov.in/" target="_blank">National Clean Air Programme</a></li>
                        <li><a href="https://pmuy.gov.in/" target="_blank">Pradhan Mantri Ujjwala Yojana</a></li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Author -->
        <div class="author-info">
            <p>Created for FIT3179 Data Visualization Assignment 2 | Monash University | October 2024</p>
            <p style="margin-top: 5px;">Data visualization demonstrates the intersection of environmental pollution and public health outcomes across Indian cities</p>
            <p style="margin-top: 5px;">© 2024 | This work is licensed under CC BY-SA 4.0</p>
        </div>
    </div>

    <script type="text/javascript">
        // Define responsive config for all visualizations
        const responsiveConfig = {
            "config": {
                "view": {
                    "continuousWidth": true,
                    "continuousHeight": 400
                },
                "background": "transparent",
                "font": "Inter, sans-serif",
                "title": {
                    "fontSize": 20,
                    "font": "Playfair Display, serif"
                },
                "axis": {
                    "labelFont": "Inter, sans-serif",
                    "titleFont": "Inter, sans-serif",
                    "titleFontWeight": 600
                },
                "legend": {
                    "labelFont": "Inter, sans-serif",
                    "titleFont": "Inter, sans-serif",
                    "titleFontWeight": 600
                }
            },
            "actions": false
        };

        // ENHANCED MAP VISUALIZATION with India topojson
        const mapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 600,
            "projection": {
                "type": "mercator",
                "center": [78, 20],
                "scale": 1100
            },
            "layer": [
                {
                    "data": {
                        "url": "https://raw.githubusercontent.com/deldersveld/topojson/master/countries/india/india-states.json",
                        "format": {
                            "type": "topojson",
                            "feature": "IND_adm1"
                        }
                    },
                    "mark": {
                        "type": "geoshape",
                        "fill": "#f0f0f0",
                        "stroke": "#cccccc",
                        "strokeWidth": 0.5
                    }
                },
                {
                    "data": {
                        "url": "data/combined_air_quality_health_data.csv"
                    },
                    "transform": [
                        {
                            "calculate": "datum.City === 'Bangalore' ? 'Bengaluru' : datum.City",
                            "as": "City_Display"
                        }
                    ],
                    "encoding": {
                        "longitude": {"field": "Longitude", "type": "quantitative"},
                        "latitude": {"field": "Latitude", "type": "quantitative"}
                    },
                    "layer": [
                        {
                            "mark": {
                                "type": "circle",
                                "opacity": 0.9,
                                "stroke": "white",
                                "strokeWidth": 2.5
                            },
                            "encoding": {
                                "size": {
                                    "field": "PM2_5_Annual_Mean",
                                    "type": "quantitative",
                                    "scale": {
                                        "type": "sqrt",
                                        "range": [300, 1500],
                                        "domain": [40, 105]
                                    },
                                    "legend": {
                                        "title": "PM2.5 Level (µg/m³)",
                                        "titleFontSize": 13,
                                        "titleFontWeight": "bold",
                                        "labelFontSize": 11,
                                        "orient": "bottom-left"
                                    }
                                },
                                "color": {
                                    "field": "PM2_5_Annual_Mean",
                                    "type": "quantitative",
                                    "scale": {
                                        "type": "threshold",
                                        "domain": [15, 35, 75],
                                        "range": ["#2ecc71", "#f39c12", "#e67e22", "#c0392b"]
                                    },
                                    "legend": {
                                        "title": "WHO Air Quality Category",
                                        "titleFontSize": 13,
                                        "titleFontWeight": "bold",
                                        "labelFontSize": 11,
                                        "orient": "bottom-right",
                                        "values": [15, 35, 75],
                                        "labelExpr": "datum.value == 15 ? 'Good (≤15)' : datum.value == 35 ? 'Moderate (15-35)' : datum.value == 75 ? 'Unhealthy (35-75)' : 'Very Unhealthy (>75)'"
                                    }
                                },
                                "tooltip": [
                                    {"field": "City_Display", "type": "nominal", "title": "City"},
                                    {"field": "State", "type": "nominal", "title": "State"},
                                    {"field": "PM2_5_Annual_Mean", "type": "quantitative", "title": "PM2.5 (µg/m³)", "format": ".1f"},
                                    {"field": "PM10_Annual_Mean", "type": "quantitative", "title": "PM10 (µg/m³)", "format": ".1f"},
                                    {"field": "ARI_Prevalence_%", "type": "quantitative", "title": "Respiratory Infections (%)", "format": ".1f"},
                                    {"field": "Clean_Fuel_Use_%", "type": "quantitative", "title": "Clean Fuel Use (%)", "format": ".1f"},
                                    {"field": "Tobacco_Men_%", "type": "quantitative", "title": "Male Tobacco Use (%)", "format": ".1f"}
                                ]
                            }
                        },
                        {
                            "mark": {
                                "type": "text",
                                "dy": -25,
                                "fontSize": 11,
                                "fontWeight": "bold"
                            },
                            "encoding": {
                                "text": {"field": "City_Display", "type": "nominal"}
                            }
                        }
                    ]
                }
            ]
        };

        // ENHANCED SCATTER PLOT with regression line and annotations
        const scatterSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 450,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "layer": [
                {
                    "mark": {
                        "type": "circle",
                        "size": 400,
                        "opacity": 0.8
                    },
                    "encoding": {
                        "x": {
                            "field": "PM2_5_Annual_Mean",
                            "type": "quantitative",
                            "scale": {"domain": [35, 110]},
                            "axis": {
                                "title": "Outdoor Air Pollution: PM2.5 Concentration (µg/m³)",
                                "titleFontSize": 14,
                                "titleFontWeight": "bold",
                                "grid": true,
                                "gridDash": [2, 2],
                                "gridOpacity": 0.3
                            }
                        },
                        "y": {
                            "field": "Clean_Fuel_Use_%",
                            "type": "quantitative",
                            "scale": {"domain": [55, 102]},
                            "axis": {
                                "title": "Indoor Air Quality: Clean Cooking Fuel Usage (%)",
                                "titleFontSize": 14,
                                "titleFontWeight": "bold",
                                "grid": true,
                                "gridDash": [2, 2],
                                "gridOpacity": 0.3
                            }
                        },
                        "color": {
                            "field": "ARI_Prevalence_%",
                            "type": "quantitative",
                            "scale": {
                                "scheme": "redyellowgreen",
                                "reverse": true,
                                "domain": [0, 3.5]
                            },
                            "legend": {
                                "title": "Respiratory Infection Rate (%)",
                                "titleFontSize": 13,
                                "titleFontWeight": "bold"
                            }
                        },
                        "size": {
                            "field": "Population_Category",
                            "type": "nominal",
                            "scale": {
                                "domain": ["1-5M", "5-10M", ">10M"],
                                "range": [200, 400, 600]
                            },
                            "legend": null
                        },
                        "tooltip": [
                            {"field": "City", "type": "nominal", "title": "City"},
                            {"field": "PM2_5_Annual_Mean", "type": "quantitative", "title": "PM2.5 (µg/m³)", "format": ".1f"},
                            {"field": "Clean_Fuel_Use_%", "type": "quantitative", "title": "Clean Fuel Use (%)", "format": ".1f"},
                            {"field": "ARI_Prevalence_%", "type": "quantitative", "title": "ARI Prevalence (%)", "format": ".1f"},
                            {"field": "Population_Category", "type": "nominal", "title": "Population Category"}
                        ]
                    }
                },
                {
                    "mark": {
                        "type": "line",
                        "color": "#667eea",
                        "strokeDash": [5, 5],
                        "opacity": 0.6,
                        "strokeWidth": 2
                    },
                    "transform": [
                        {
                            "regression": "Clean_Fuel_Use_%",
                            "on": "PM2_5_Annual_Mean",
                            "method": "linear"
                        }
                    ],
                    "encoding": {
                        "x": {"field": "PM2_5_Annual_Mean", "type": "quantitative"},
                        "y": {"field": "Clean_Fuel_Use_%", "type": "quantitative"}
                    }
                },
                {
                    "mark": {
                        "type": "text",
                        "dy": -15,
                        "fontSize": 10,
                        "fontWeight": "bold"
                    },
                    "encoding": {
                        "x": {"field": "PM2_5_Annual_Mean", "type": "quantitative"},
                        "y": {"field": "Clean_Fuel_Use_%", "type": "quantitative"},
                        "text": {"field": "City", "type": "nominal"}
                    }
                },
                {
                    "mark": {
                        "type": "rule",
                        "color": "#c0392b",
                        "strokeDash": [3, 3],
                        "opacity": 0.5
                    },
                    "data": {"values": [{"WHO_Limit": 15}]},
                    "encoding": {
                        "x": {"datum": 15}
                    }
                },
                {
                    "mark": {
                        "type": "text",
                        "align": "left",
                        "baseline": "bottom",
                        "dx": 5,
                        "dy": -5,
                        "fontSize": 10,
                        "color": "#c0392b"
                    },
                    "data": {"values": [{"text": "WHO Limit", "x": 15, "y": 100}]},
                    "encoding": {
                        "x": {"field": "x", "type": "quantitative"},
                        "y": {"field": "y", "type": "quantitative"},
                        "text": {"field": "text", "type": "nominal"}
                    }
                }
            ]
        };

        // ENHANCED BAR CHART with better interactivity
        const barSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "transform": [
                {
                    "fold": ["PM2_5_Annual_Mean", "Clean_Fuel_Use_%", "ARI_Prevalence_%"],
                    "as": ["Metric", "Value"]
                },
                {
                    "calculate": "datum.Metric === 'PM2_5_Annual_Mean' ? 'PM2.5 Level' : datum.Metric === 'Clean_Fuel_Use_%' ? 'Clean Fuel Use (%)' : 'Respiratory Infections (%)'",
                    "as": "Metric_Label"
                },
                {
                    "calculate": "datum.Metric === 'PM2_5_Annual_Mean' ? datum.Value : datum.Metric === 'Clean_Fuel_Use_%' ? (100 - datum.Value) : datum.Value * 10",
                    "as": "Normalized_Value"
                }
            ],
            "params": [
                {
                    "name": "metric_selection",
                    "select": {"type": "point", "fields": ["Metric_Label"]},
                    "bind": "legend"
                }
            ],
            "mark": {
                "type": "bar",
                "cornerRadiusEnd": 4
            },
            "encoding": {
                "x": {
                    "field": "City",
                    "type": "nominal",
                    "axis": {
                        "title": null,
                        "labelAngle": -45,
                        "labelFontSize": 12
                    },
                    "sort": "-y"
                },
                "y": {
                    "field": "Value",
                    "type": "quantitative",
                    "axis": {
                        "title": "Value",
                        "titleFontSize": 14,
                        "titleFontWeight": "bold",
                        "grid": true,
                        "gridDash": [2, 2],
                        "gridOpacity": 0.3
                    }
                },
                "color": {
                    "field": "Metric_Label",
                    "type": "nominal",
                    "scale": {
                        "domain": ["PM2.5 Level", "Clean Fuel Use (%)", "Respiratory Infections (%)"],
                        "range": ["#e74c3c", "#2ecc71", "#3498db"]
                    },
                    "legend": {
                        "title": "Metric (Click to Filter)",
                        "titleFontSize": 13,
                        "titleFontWeight": "bold",
                        "orient": "top"
                    }
                },
                "opacity": {
                    "condition": {"param": "metric_selection", "value": 1},
                    "value": 0.2
                },
                "xOffset": {"field": "Metric_Label"},
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Metric_Label", "type": "nominal", "title": "Metric"},
                    {"field": "Value", "type": "quantitative", "format": ".1f"}
                ]
            }
        };

        // TIME SERIES VISUALIZATION
        const timeSeriesSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/pm25_timeseries_data.csv"
            },
            "params": [
                {
                    "name": "city_selection",
                    "select": {"type": "point", "fields": ["City"]},
                    "bind": "legend"
                }
            ],
            "mark": {
                "type": "line",
                "point": true,
                "strokeWidth": 2
            },
            "encoding": {
                "x": {
                    "field": "Month_Name",
                    "type": "ordinal",
                    "axis": {
                        "title": "Month",
                        "titleFontSize": 14,
                        "titleFontWeight": "bold",
                        "labelAngle": -45
                    },
                    "sort": ["January", "February", "March", "April", "May", "June", 
                            "July", "August", "September", "October", "November", "December"]
                },
                "y": {
                    "field": "PM2_5",
                    "type": "quantitative",
                    "axis": {
                        "title": "PM2.5 Concentration (µg/m³)",
                        "titleFontSize": 14,
                        "titleFontWeight": "bold",
                        "grid": true,
                        "gridDash": [2, 2],
                        "gridOpacity": 0.3
                    }
                },
                "color": {
                    "field": "City",
                    "type": "nominal",
                    "scale": {
                        "scheme": "category10"
                    },
                    "legend": {
                        "title": "City (Click to Filter)",
                        "titleFontSize": 13,
                        "titleFontWeight": "bold"
                    }
                },
                "opacity": {
                    "condition": {"param": "city_selection", "value": 1},
                    "value": 0.1
                },
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Month_Name", "type": "ordinal", "title": "Month"},
                    {"field": "PM2_5", "type": "quantitative", "title": "PM2.5", "format": ".1f"},
                    {"field": "Season", "type": "nominal"},
                    {"field": "Event_Type", "type": "nominal", "title": "Special Event"}
                ]
            }
        };

        // HEATMAP
        const heatmapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "transform": [
                {
                    "fold": [
                        "PM2_5_Annual_Mean",
                        "ARI_Prevalence_%", 
                        "Tobacco_Men_%",
                        "Stunted_Children_%",
                        "Wasted_Children_%"
                    ],
                    "as": ["Indicator", "Value"]
                },
                {
                    "calculate": "datum.Indicator === 'PM2_5_Annual_Mean' ? 'PM2.5 Level' : datum.Indicator === 'ARI_Prevalence_%' ? 'Respiratory Infections' : datum.Indicator === 'Tobacco_Men_%' ? 'Male Tobacco Use' : datum.Indicator === 'Stunted_Children_%' ? 'Child Stunting' : 'Child Wasting'",
                    "as": "Indicator_Label"
                },
                {
                    "calculate": "datum.Indicator === 'PM2_5_Annual_Mean' ? datum.Value / 100 : datum.Value",
                    "as": "Normalized_Value"
                }
            ],
            "mark": {
                "type": "rect",
                "cornerRadius": 4
            },
            "encoding": {
                "x": {
                    "field": "Indicator_Label",
                    "type": "nominal",
                    "axis": {
                        "title": null,
                        "labelAngle": -45,
                        "labelFontSize": 11
                    }
                },
                "y": {
                    "field": "City",
                    "type": "nominal",
                    "axis": {
                        "title": null,
                        "labelFontSize": 11
                    },
                    "sort": {"op": "mean", "field": "Normalized_Value", "order": "descending"}
                },
                "color": {
                    "field": "Normalized_Value",
                    "type": "quantitative",
                    "scale": {
                        "scheme": "viridis"
                    },
                    "legend": {
                        "title": "Risk Level (Normalized)",
                        "titleFontSize": 12
                    }
                },
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Indicator_Label", "type": "nominal", "title": "Indicator"},
                    {"field": "Value", "type": "quantitative", "format": ".1f", "title": "Actual Value"}
                ]
            }
        };

        // HEALTH RANKING - Stacked bar
        const healthRankingSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/nfhs_health_summary.csv"
            },
            "transform": [
                {
                    "fold": ["Stunted_Children_%", "Wasted_Children_%", "Tobacco_Men_%"],
                    "as": ["Health_Indicator", "Percentage"]
                },
                {
                    "calculate": "datum.Health_Indicator === 'Stunted_Children_%' ? 'Child Stunting' : datum.Health_Indicator === 'Wasted_Children_%' ? 'Child Wasting' : 'Male Tobacco Use'",
                    "as": "Indicator_Label"
                }
            ],
            "mark": {
                "type": "bar",
                "cornerRadius": 4
            },
            "encoding": {
                "y": {
                    "field": "City",
                    "type": "nominal",
                    "axis": {
                        "title": null,
                        "labelFontSize": 12
                    },
                    "sort": "-x"
                },
                "x": {
                    "field": "Percentage",
                    "type": "quantitative",
                    "stack": "zero",
                    "axis": {
                        "title": "Cumulative Health Risk Factors (%)",
                        "titleFontSize": 14,
                        "titleFontWeight": "bold"
                    }
                },
                "color": {
                    "field": "Indicator_Label",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Child Stunting", "Child Wasting", "Male Tobacco Use"],
                        "range": ["#e74c3c", "#f39c12", "#9b59b6"]
                    },
                    "legend": {
                        "title": "Health Risk Factor",
                        "titleFontSize": 13,
                        "titleFontWeight": "bold",
                        "orient": "top"
                    }
                },
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Indicator_Label", "type": "nominal", "title": "Indicator"},
                    {"field": "Percentage", "type": "quantitative", "title": "Percentage", "format": ".1f"}
                ]
            }
        };

        // PARALLEL COORDINATES
        const parallelSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "transform": [
                {
                    "fold": [
                        "PM2_5_Annual_Mean",
                        "Clean_Fuel_Use_%",
                        "Tobacco_Men_%",
                        "Stunted_Children_%",
                        "Wasted_Children_%"
                    ],
                    "as": ["Indicator", "Value"]
                },
                {
                    "calculate": "datum.Indicator === 'PM2_5_Annual_Mean' ? 'PM2.5' : datum.Indicator === 'Clean_Fuel_Use_%' ? 'Clean Fuel' : datum.Indicator === 'Tobacco_Men_%' ? 'Male Tobacco' : datum.Indicator === 'Stunted_Children_%' ? 'Child Stunting' : 'Child Wasting'",
                    "as": "Indicator_Name"
                },
                {
                    "joinaggregate": [
                        {"op": "min", "field": "Value", "as": "min_val"},
                        {"op": "max", "field": "Value", "as": "max_val"}
                    ],
                    "groupby": ["Indicator"]
                },
                {
                    "calculate": "(datum.Value - datum.min_val) / (datum.max_val - datum.min_val) * 100",
                    "as": "Normalized_Value"
                }
            ],
            "params": [
                {
                    "name": "city_highlight",
                    "select": {"type": "point", "fields": ["City"]},
                    "bind": "legend"
                }
            ],
            "mark": {"type": "line", "point": true, "strokeWidth": 2},
            "encoding": {
                "x": {
                    "field": "Indicator_Name",
                    "type": "nominal",
                    "axis": {
                        "title": null,
                        "labelAngle": -45,
                        "labelFontSize": 12
                    }
                },
                "y": {
                    "field": "Normalized_Value",
                    "type": "quantitative",
                    "axis": {
                        "title": "Normalized Value (0-100)",
                        "titleFontSize": 14,
                        "grid": true
                    }
                },
                "color": {
                    "field": "City",
                    "type": "nominal",
                    "legend": {
                        "title": "City (Click to Highlight)",
                        "titleFontSize": 13
                    }
                },
                "opacity": {
                    "condition": {"param": "city_highlight", "value": 1},
                    "value": 0.1
                },
                "detail": {"field": "City", "type": "nominal"},
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Indicator_Name", "type": "nominal", "title": "Indicator"},
                    {"field": "Value", "type": "quantitative", "format": ".1f", "title": "Actual Value"},
                    {"field": "Normalized_Value", "type": "quantitative", "format": ".1f", "title": "Normalized (0-100)"}
                ]
            }
        };

        // BUBBLE CHART
        const bubbleSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "transform": [
                {
                    "calculate": "datum.Population_Category === '1-5M' ? 3 : datum.Population_Category === '5-10M' ? 7 : 14",
                    "as": "Population_Estimate"
                }
            ],
            "mark": {
                "type": "circle",
                "opacity": 0.8
            },
            "encoding": {
                "x": {
                    "field": "PM2_5_Annual_Mean",
                    "type": "quantitative",
                    "scale": {"domain": [35, 110]},
                    "axis": {
                        "title": "PM2.5 Level (µg/m³)",
                        "titleFontSize": 14,
                        "grid": true
                    }
                },
                "y": {
                    "field": "ARI_Prevalence_%",
                    "type": "quantitative",
                    "axis": {
                        "title": "Respiratory Infection Rate (%)",
                        "titleFontSize": 14,
                        "grid": true
                    }
                },
                "size": {
                    "field": "Population_Estimate",
                    "type": "quantitative",
                    "scale": {"range": [200, 2000]},
                    "legend": {
                        "title": "Population (Millions)",
                        "titleFontSize": 12
                    }
                },
                "color": {
                    "field": "Clean_Fuel_Use_%",
                    "type": "quantitative",
                    "scale": {"scheme": "greenblue"},
                    "legend": {
                        "title": "Clean Fuel Use (%)",
                        "titleFontSize": 12
                    }
                },
                "tooltip": [
                    {"field": "City", "type": "nominal"},
                    {"field": "Population_Category", "type": "nominal", "title": "Population Category"},
                    {"field": "PM2_5_Annual_Mean", "type": "quantitative", "title": "PM2.5", "format": ".1f"},
                    {"field": "ARI_Prevalence_%", "type": "quantitative", "title": "ARI (%)", "format": ".1f"},
                    {"field": "Clean_Fuel_Use_%", "type": "quantitative", "title": "Clean Fuel (%)", "format": ".1f"}
                ]
            }
        };

        // RADIAL CHART
        const radialSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": "container",
            "height": 400,
            "data": {
                "url": "data/combined_air_quality_health_data.csv"
            },
            "layer": [
                {
                    "mark": {"type": "arc", "innerRadius": 30, "stroke": "white"},
                    "encoding": {
                        "theta": {"field": "PM2_5_Annual_Mean", "type": "quantitative", "stack": true},
                        "radius": {"field": "PM2_5_Annual_Mean", "scale": {"type": "sqrt", "zero": true, "range": [30, 150]}},
                        "color": {
                            "field": "City",
                            "type": "nominal",
                            "scale": {"scheme": "category10"},
                            "legend": {
                                "title": "City",
                                "titleFontSize": 13,
                                "titleFontWeight": "bold"
                            }
                        },
                        "tooltip": [
                            {"field": "City", "type": "nominal"},
                            {"field": "PM2_5_Annual_Mean", "type": "quantitative", "title": "PM2.5", "format": ".1f"},
                            {"field": "Population_Category", "type": "nominal", "title": "Population"}
                        ]
                    }
                }
            ]
        };

        // Embed all visualizations with responsive config
        vegaEmbed('#map', mapSpec, responsiveConfig);
        vegaEmbed('#scatter', scatterSpec, responsiveConfig);
        vegaEmbed('#barchart', barSpec, responsiveConfig);
        vegaEmbed('#timeseries', timeSeriesSpec, responsiveConfig);
        vegaEmbed('#heatmap', heatmapSpec, responsiveConfig);
        vegaEmbed('#health_ranking', healthRankingSpec, responsiveConfig);
        vegaEmbed('#parallel', parallelSpec, responsiveConfig);
        vegaEmbed('#bubble_chart', bubbleSpec, responsiveConfig);
        vegaEmbed('#radial', radialSpec, responsiveConfig);

        // Animate elements on scroll
        const observerOptions = {
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        document.querySelectorAll('.section').forEach(section => {
            section.style.opacity = '0';
            section.style.transform = 'translateY(20px)';
            section.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
            observer.observe(section);
        });
    </script>
</body>
</html>